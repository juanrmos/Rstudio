"0","# Preparar datos para curva de Pareto"
"0","pareto <- datos %>%"
"0","  group_by(Razon_Social) %>%"
"0","  summarise(Monto_Total = sum(Monto_limpio)) %>%"
"0","  arrange(desc(Monto_Total)) %>%"
"0","  mutate("
"0","    Acumulado = cumsum(Monto_Total),"
"0","    Porcentaje_Acum = Acumulado / sum(Monto_Total) * 100,"
"0","    Proveedor_ID = row_number()"
"0","  )"
"0",""
"0","# Gráfico de Pareto corregido"
"0","Pareto = ggplot(pareto, aes(x = Proveedor_ID)) +"
"0","  geom_bar(aes(y = Monto_Total), stat = ""identity"", fill = ""steelblue"", alpha = 0.7) +"
"0","  geom_line(aes(y = Acumulado * max(Monto_Total) / max(Acumulado)), "
"0","            color = ""red"", linewidth = 1) +"
"0","  geom_point(aes(y = Acumulado * max(Monto_Total) / max(Acumulado)), "
"0","             color = ""red"", size = 2) +"
"0","  scale_y_continuous("
"0","    name = ""Monto por Proveedor (S/.)"","
"0","    labels = comma,"
"0","    sec.axis = sec_axis("
"0","      ~ . / max(pareto$Monto_Total) * 100, "
"0","      name = ""Porcentaje Acumulado (%)"","
"0","      labels = function(x) paste0(round(x, 1), ""%"")"
"0","    )"
"0","  ) +"
"0","  labs("
"0","    title = ""Curva de Pareto de Proveedores"","
"0","    x = ""Proveedores (ordenados por monto)"","
"0","    caption = ""Las barras muestran el monto individual, la línea roja muestra el acumulado"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  theme("
"0","    plot.title = element_text(size = 14, face = ""bold""),"
"0","    axis.title = element_text(size = 12)"
"0","  )"
"0",""
"0","Pareto"
