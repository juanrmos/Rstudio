"0","# Calcular diferencia en días (con filtros y validaciones)"
"0","datos <- datos %>%"
"0","  filter(!is.na(Fecha_Emision) & !is.na(Fecha_Compromiso)) %>%  # Filtrar fechas nulas"
"0","  mutate(Dias_Procesamiento = as.numeric(difftime(Fecha_Compromiso, Fecha_Emision, units = ""days""))) %>%"
"0","  # Filtrar valores extremos o negativos (opcional, según tu contexto)"
"0","  filter(Dias_Procesamiento >= 0 & Dias_Procesamiento <= 365)  # Máximo 1 año"
"0",""
"0",""
"0","# Histograma mejorado"
"0","ggplot(datos, aes(x = Dias_Procesamiento)) +"
"0","  geom_histogram(binwidth = 1, fill = ""orange"", color = ""black"", alpha = 0.7) +"
"0","  geom_vline(aes(xintercept = mean(Dias_Procesamiento, na.rm = TRUE)), "
"0","             color = ""red"", linetype = ""dashed"", linewidth = 1) +"
"0","  geom_vline(aes(xintercept = median(Dias_Procesamiento, na.rm = TRUE)), "
"0","             color = ""blue"", linetype = ""dashed"", linewidth = 1) +"
"0","  labs("
"0","    title = ""Distribución del Tiempo de Procesamiento de Órdenes"","
"0","    subtitle = ""Línea roja: promedio | Línea azul: mediana"","
"0","    x = ""Días entre Emisión y Compromiso"", "
"0","    y = ""Cantidad de Órdenes"","
"0","    caption = paste0(""n = "", nrow(datos), "" órdenes con fechas válidas"")"
"0","  ) +"
"0","  scale_x_continuous(breaks = seq(0, max(datos$Dias_Procesamiento, na.rm = TRUE), by = 5)) +"
"0","  theme_minimal() +"
"0","  theme("
"0","    plot.title = element_text(size = 14, face = ""bold""),"
"0","    plot.subtitle = element_text(size = 11, color = ""gray60""),"
"0","    axis.text.x = element_text(angle = 45, hjust = 1)"
"0","  )"
