"0","# Órdenes por día (filtrando fechas válidas)"
"0","ordenes_por_dia <- datos %>%"
"0","  filter(!is.na(Fecha_Emision)) %>%  # Eliminar fechas nulas"
"0","  group_by(Fecha_Emision) %>%"
"0","  summarise("
"0","    Ordenes = n(),"
"0","    Monto_Total = sum(Monto_limpio)"
"0","  ) %>%"
"0","  arrange(Fecha_Emision)  # Ordenar por fecha"
"0",""
"0","# Calcular factor de escalado dinámico"
"0","factor_escala <- max(ordenes_por_dia$Ordenes) / max(ordenes_por_dia$Monto_Total)"
"0",""
"0","# Gráfico combinado: barras para cantidad, línea para monto"
"0","Ordenes_dia = ggplot(ordenes_por_dia, aes(x = Fecha_Emision)) +"
"0","  geom_col(aes(y = Ordenes), fill = ""steelblue"", alpha = 0.7) +"
"0","  geom_line(aes(y = Monto_Total * factor_escala), color = ""red"", linewidth = 1) +"
"0","  geom_point(aes(y = Monto_Total * factor_escala), color = ""red"", size = 2) +"
"0","  scale_x_date(date_breaks = ""1 week"", date_labels = ""%d/%m"") +  # Formato de fechas"
"0","  scale_y_continuous("
"0","    name = ""Número de Órdenes"","
"0","    sec.axis = sec_axis("
"0","      ~ . / factor_escala, "
"0","      name = ""Monto Total (S/.)"", "
"0","      labels = function(x) paste0(""S/. "", comma(x))"
"0","    )"
"0","  ) +"
"0","  labs("
"0","    title = ""Órdenes y Monto Total por Día"","
"0","    subtitle = ""Barras azules: cantidad de órdenes | Línea roja: monto total"","
"0","    x = ""Fecha de Emisión"","
"0","    caption = ""Nota: Los dos ejes tienen escalas diferentes"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  theme("
"0","    plot.title = element_text(size = 14, face = ""bold""),"
"0","    plot.subtitle = element_text(size = 11, color = ""gray60""),"
"0","    axis.text.x = element_text(angle = 45, hjust = 1),"
"0","    legend.position = ""none"""
"0","  )"
"0",""
"0","Ordenes_dia"
