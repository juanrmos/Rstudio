"0","# Cargar librerías necesarias"
"0","library(readxl)"
"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(lubridate)"
"0","library(stringr)"
"0","library(scales)"
"0","library(tidyr)"
"0","library(forcats)"
"0","library(ggrepel)"
"0","library(patchwork)"
"0",""
"0",""
"0","# 1. LIMPIEZA Y PREPARACIÓN DE DATOS"
"0",""
"0",""
"0","# Cargar los datos"
"0","datos <- read_excel(""DRTC-H.xlsx"")"
"0",""
"0",""
"0","# Corregir nombres de columnas (quitar acentos y caracteres especiales)"
"0","names(datos) <- c(""N"", ""Entidad"", ""Tipo_Orden"", ""Numero_Orden"", ""Tipo_Contratacion"","
"0","                  ""Fecha_Emision"", ""Fecha_Compromiso"", ""Monto"", ""RUC"", "
"0","                  ""Razon_Social"", ""Estado"", ""Estado_Registro"", ""Observaciones"")"
"0",""
"0","# Convertir fechas a formato Date"
"0","datos <- datos %>%"
"0","  mutate("
"0","    Fecha_Emision = as.Date(Fecha_Emision),"
"0","    Fecha_Compromiso = as.Date(Fecha_Compromiso)"
"0","  )"
"0",""
"0",""
"0","# Convertir montos a numérico"
"0","datos <- datos %>%"
"0","  mutate("
"0","    Monto_limpio = as.numeric(gsub("","", """", gsub(""^S/\\. "", """", Monto)))"
"0","  )"
"0",""
"0",""
"0",""
"0","# Eliminar filas con montos nulos si las hay"
"0","datos <- datos %>% filter(!is.na(Monto_limpio))"
"0","datos <- datos %>%"
"0","  mutate(Nombre_Corto = ifelse(nchar(Razon_Social) > 15, "
"0","                               paste0(substr(Razon_Social, 1, 12), ""...""), "
"0","                               Razon_Social))"
"0",""
"0",""
"0",""
