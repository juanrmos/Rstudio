"0",""
"0",""
"0","# Filtrar anuladas"
"0","anuladas <- datos %>% filter(Estado == ""Anulada"")"
"0",""
"0","# Estad√≠sticas b√°sicas"
"0","total_ordenes <- nrow(datos)"
"0","total_anuladas <- nrow(anuladas)"
"0","porcentaje_anuladas <- round((total_anuladas / total_ordenes) * 100, 2)"
"0",""
"0","    # Gr√°fico 2: Cantidad por tipo (si hay variedad)"
"0","    if(nrow(anuladas) > 1) {"
"0","      p2 <- ggplot(anuladas, aes(x = reorder(Tipo_Orden, Cantidad), "
"0","                                         y = Cantidad, fill = Tipo_Orden)) +"
"0","        geom_col(alpha = 0.8) +"
"0","        geom_text(aes(label = Cantidad), hjust = -0.1, fontface = ""bold"") +"
"0","        coord_flip() +"
"0","        labs(title = ""Cantidad de √ìrdenes Anuladas por Tipo"","
"0","             x = ""Tipo de Orden"", y = ""Cantidad de √ìrdenes"") +"
"0","        scale_y_continuous(expand = expansion(mult = c(0, 0.15))) +"
"0","        theme_minimal() +"
"0","        theme(legend.position = ""none"","
"0","              plot.title = element_text(face = ""bold""))"
"0","      "
"0","      print(p2)"
"0","    } else if(total_anuladas > 0) {"
"0","    # Gr√°fico simple para pocos casos"
"0","    Anuladas1= ggplot(anuladas, aes(x = Tipo_Orden, y = Monto_limpio, fill = Tipo_Orden)) +"
"0","      geom_col(alpha = 0.8) +"
"0","      geom_text(aes(label = paste0(""S/. "", comma(Monto_limpio))), "
"0","                vjust = -0.3, fontface = ""bold"") +"
"0","      labs(title = paste0(""√ìrdenes Anuladas ("", total_anuladas, "" casos)""),"
"0","           x = ""Tipo de Orden"", y = ""Monto (S/.)"") +"
"0","      scale_y_continuous(labels = function(x) paste0(""S/. "", comma(x)),"
"0","                        expand = expansion(mult = c(0, 0.15))) +"
"0","      theme_minimal() +"
"0","      theme(legend.position = ""none"","
"0","            plot.title = element_text(face = ""bold""))"
"0","      "
"0","      ggsave(""Anuladas1.png"", plot = Anuladas1,"
"0","width = 8, height = 6, dpi = 300)"
"0","      Anuladas1"
"0","  }"
"1","[1m[33mError[39m in `geom_col()`:[22m
[38;5;252m[33m![38;5;252m Problem while computing aesthetics.
[36m‚Ñπ[38;5;252m Error occurred in the 1st layer.[39m
[1mCaused by error:[22m
[33m![39m objeto 'Cantidad' no encontrado
[90mRun `]8;;x-r-run:rlang::last_trace()rlang::last_trace()]8;;` to see where the error occurred.[39m
"
