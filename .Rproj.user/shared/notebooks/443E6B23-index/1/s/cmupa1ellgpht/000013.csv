"0","total_general <- sum(datos$Monto_limpio)"
"0",""
"0","# Luego calculamos el top 5 y los porcentajes"
"0","top5_proveedores <- datos %>%"
"0","  group_by(Razon_Social) %>%"
"0","  summarise(Monto_Total = sum(Monto_limpio)) %>%"
"0","  arrange(desc(Monto_Total)) %>%"
"0","  mutate(Porcentaje = Monto_Total / total_general * 100) %>%  "
"0","  slice_head(n = 5)"
"0",""
"0","Top5 = ggplot(top5_proveedores, aes(x = reorder(Razon_Social, Monto_Total), y = Monto_Total, fill = Razon_Social)) +"
"0","  geom_bar(stat = ""identity"") +"
"0","  coord_flip() +"
"0","  geom_text(aes(label = paste0(round(Porcentaje, 1), ""%"")), hjust = -0.2) +"
"0","  labs(title = ""Top 5 Proveedores por Monto y % del Total"","
"0","       x = ""Proveedor"", y = ""Monto Total (S/.)"") +"
"0","  scale_y_continuous(labels = comma) +"
"0","  theme_minimal() +"
"0","  theme(legend.position = ""none"")"
"0",""
"0","Top5"
