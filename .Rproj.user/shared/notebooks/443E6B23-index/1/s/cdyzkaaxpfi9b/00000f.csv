"0","# Clasificación por tipo de RUC"
"0","datos <- datos %>%"
"0","  mutate(Tipo_Proveedor = case_when("
"0","    str_starts(RUC, ""10"") ~ ""Persona Natural"","
"0","    str_starts(RUC, ""20"") ~ ""Persona Jurídica"","
"0","    TRUE ~ ""Otro"""
"0","  ))"
"0",""
"0","# Distribución de montos por tipo de proveedor"
"0","total_general <- sum(datos$Monto_limpio)"
"0",""
"0","dist_tipo <- datos %>%"
"0","  group_by(Tipo_Proveedor) %>%"
"0","  summarise(Monto_Total = sum(Monto_limpio)) %>%"
"0","  mutate("
"0","    Porcentaje = Monto_Total / total_general * 100,"
"0","    Etiqueta = paste0(""S/ "", comma(round(Monto_Total,0)), "
"0","                      "" ("", round(Porcentaje,1), ""%)"")"
"0","  )"
"0",""
"0",""
"0","# Gráfico circular mejorado con montos y porcentajes"
"0","Tipo_Prov = ggplot(dist_tipo, aes(x = """", y = Monto_Total, fill = Tipo_Proveedor)) +"
"0","  geom_bar(stat = ""identity"", width = 1) +"
"0","  coord_polar(""y"") +"
"0","  geom_text(aes(label = Etiqueta), "
"0","            position = position_stack(vjust = 0.5),"
"0","            color = ""white"", fontface = ""bold"", size = 4.2) +"
"0","  labs(title = ""Distribución del Gasto por Tipo de Proveedor"","
"0","       fill = ""Tipo de Proveedor"") +"
"0","  scale_fill_manual(values = c(""Persona Natural"" = ""#3498db"", "
"0","                               ""Persona Jurídica"" = ""#e74c3c"", "
"0","                               ""Otro"" = ""#95a5a6"")) +"
"0","  theme_void() +"
"0","  theme("
"0","    plot.title = element_text(size = 14, face = ""bold"", hjust = 0.5),"
"0","    legend.position = ""bottom"","
"0","    legend.title = element_text(face = ""bold"")"
"0","  )"
"0",""
"0","Tipo_Prov"
