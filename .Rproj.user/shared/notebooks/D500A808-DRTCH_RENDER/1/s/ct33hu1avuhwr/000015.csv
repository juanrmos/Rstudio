"0","proveedores_sospechosos <- concentracion_proveedores %>%"
"0","  mutate("
"0","    # Bandera 1: Proveedor nuevo con contratos grandes"
"0","    Nueva_Empresa = as.numeric(Primera_Orden - as.Date(""2023-01-01"")) < 365,"
"0","    Contrato_Grande = Monto_Total > quantile(Monto_Total, 0.75),"
"0","    "
"0","    # Bandera 2: Solo una orden pero monto alto"
"0","    Una_Sola_Orden = Num_Ordenes == 1,"
"0","    Monto_Sospechoso = Monto_Total > quantile(Monto_Total, 0.90),"
"0","    "
"0","    # Bandera 3: Actividad concentrada en periodo corto"
"0","    Dias_Activo = as.numeric(Ultima_Orden - Primera_Orden),"
"0","    Actividad_Corta = Dias_Activo < 30 & Num_Ordenes > 1,"
"0","    "
"0","    # Score de riesgo"
"0","    Score_Riesgo = Nueva_Empresa * 2 + Contrato_Grande + Una_Sola_Orden * 2 + "
"0","                   Monto_Sospechoso * 3 + Actividad_Corta * 2"
"0","  ) %>%"
"0","  filter(Score_Riesgo >= 3) %>%"
"0","  select(RUC, Razon_Social, Monto_Total, Num_Ordenes, Primera_Orden, "
"0","         Dias_Activo, Score_Riesgo) %>%"
"0","  arrange(desc(Score_Riesgo))"
"0",""
"0","print(""PROVEEDORES DE ALTO RIESGO (Posibles empresas fantasma):"")"
"1","[1]"
"1"," ""PROVEEDORES DE ALTO RIESGO (Posibles empresas fantasma):"""
"1","
"
"0","print(head(proveedores_sospechosos, 10))"
