"0","presupuesto_oficial <- data.frame("
"0","  Año = c(2023, 2024, 2025),"
"0","  PIM = c(1999726251, 1961841636, 1905495522),  # Presupuesto Institucional Modificado"
"0","  Ejecutado_Oficial = c(1839965157, 1866031196, 1232661856),  # Según reporte oficial"
"0","  Porcentaje_Oficial = c(92.0, 95.1, 64.7)"
"0",")"
"0",""
"0","# Calcular gasto real detectado"
"0","gasto_real_detectado <- datos %>%"
"0","  group_by(Año) %>%"
"0","  summarise("
"0","    Gasto_Detectado = sum(Monto_limpio),"
"0","    .groups = 'drop'"
"0","  )"
"0",""
"0","analisis_presupuesto <- presupuesto_oficial %>%"
"0","  left_join(gasto_real_detectado, by = ""Año"") %>%"
"0","  mutate("
"0","    Gasto_Detectado = replace_na(Gasto_Detectado, 0),"
"0","    Porcentaje_Detectado = (Gasto_Detectado / PIM) * 100,"
"0","    Diferencia_Oficial_Detectado = Ejecutado_Oficial - Gasto_Detectado,"
"0","    Porcentaje_No_Registrado = (Diferencia_Oficial_Detectado / Ejecutado_Oficial) * 100"
"0","  )"
"0",""
"0","print(analisis_presupuesto)"
