"0","datos_graf_presupuesto <- analisis_presupuesto %>%"
"0","  select(Año, PIM, Ejecutado_Oficial, Gasto_Detectado) %>%"
"0","  pivot_longer(cols = c(PIM, Ejecutado_Oficial, Gasto_Detectado), "
"0","               names_to = ""Tipo"", values_to = ""Monto"") %>%"
"0","  mutate(Tipo = factor(Tipo, levels = c(""PIM"", ""Ejecutado_Oficial"", ""Gasto_Detectado"")))"
"0",""
"0","grafico_presupuesto <- ggplot(datos_graf_presupuesto, "
"0","                              aes(x = factor(Año), y = Monto/1000000, fill = Tipo)) +"
"0","  geom_bar(stat = ""identity"", position = ""dodge"", alpha = 0.8) +"
"0","  scale_fill_manual(values = c(""PIM"" = ""#95a5a6"", "
"0","                               ""Ejecutado_Oficial"" = ""#3498db"", "
"0","                               ""Gasto_Detectado"" = ""#e74c3c""),"
"0","                    labels = c(""Presupuesto Modificado"", ""Ejecutado (Oficial)"", ""Detectado (Datos)"")) +"
"0","  labs("
"0","    title = ""Comparación: Presupuesto vs. Ejecución vs. Detectado"","
"0","    subtitle = ""Diferencias significativas sugieren gastos no registrados o mal clasificados"","
"0","    x = ""Año"","
"0","    y = ""Monto (Millones S/)"","
"0","    fill = ""Tipo"""
"0","  ) +"
"0","  theme_minimal() +"
"0","  geom_text(aes(label = round(Monto/1000000, 0)), "
"0","            position = position_dodge(width = 0.9), "
"0","            vjust = -0.5, size = 3)"
"0",""
"0","print(grafico_presupuesto)"
