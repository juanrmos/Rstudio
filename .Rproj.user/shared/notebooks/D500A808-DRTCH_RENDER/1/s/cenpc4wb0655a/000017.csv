"0","# ========================================"
"0","# 6. ANÁLISIS DE PRECIOS ANÓMALOS"
"0","# ========================================"
"0",""
"0","# Agrupar por tipo de contratación para comparar precios"
"0","analisis_precios <- datos %>%"
"0","  group_by(Tipo_Contratacion) %>%"
"0","  mutate("
"0","    Q1 = quantile(Monto_limpio, 0.25),"
"0","    Q3 = quantile(Monto_limpio, 0.75),"
"0","    IQR = Q3 - Q1,"
"0","    Limite_Superior = Q3 + 1.5 * IQR,"
"0","    Limite_Inferior = Q1 - 1.5 * IQR,"
"0","    Es_Outlier = Monto_limpio > Limite_Superior | Monto_limpio < Limite_Inferior"
"0","  )"
"0",""
"0","ordenes_precio_anomalo <- analisis_precios %>%"
"0","  filter(Es_Outlier == TRUE) %>%"
"0","  select(Numero_Orden, RUC, Razon_Social, Tipo_Contratacion, "
"0","         Fecha_Emision, Monto_limpio, Limite_Superior) %>%"
"0","  mutate("
"0","    Sobreprecio_Porcentaje = ((Monto_limpio - Limite_Superior) / Limite_Superior) * 100"
"0","  ) %>%"
"0","  filter(Sobreprecio_Porcentaje > 0) %>%"
"0","  arrange(desc(Sobreprecio_Porcentaje))"
"0",""
"0","print(""ÓRDENES CON SOBREPRECIOS DETECTADOS:"")"
"1","[1]"
"1"," ""ÓRDENES CON SOBREPRECIOS DETECTADOS:"""
"1","
"
"0","print(head(ordenes_precio_anomalo, 15))"
