"0","# ========================================"
"0","# 4. ANÁLISIS TEMPORAL DE ANOMALÍAS"
"0","# ========================================"
"0",""
"0","# A. Detectar picos inusuales de gasto"
"0","analisis_temporal <- datos %>%"
"0","  mutate("
"0","    Año_Mes = floor_date(Fecha_Emision, ""month"")"
"0","  ) %>%"
"0","  group_by(Año_Mes) %>%"
"0","  summarise("
"0","    Monto_Mensual = sum(Monto_limpio),"
"0","    Num_Ordenes = n(),"
"0","    Monto_Promedio_Orden = mean(Monto_limpio),"
"0","    .groups = 'drop'"
"0","  )"
"0",""
"0","# Calcular límites de control estadístico (3 sigmas)"
"0","media_mensual <- mean(analisis_temporal$Monto_Mensual)"
"0","sd_mensual <- sd(analisis_temporal$Monto_Mensual)"
"0","limite_superior <- media_mensual + 3 * sd_mensual"
"0",""
"0","meses_anomalos <- analisis_temporal %>%"
"0","  filter(Monto_Mensual > limite_superior) %>%"
"0","  mutate("
"0","    Desviacion_Estandar = (Monto_Mensual - media_mensual) / sd_mensual"
"0","  )"
"0",""
"0","print(""MESES CON GASTOS ANÓMALOS (>3 sigmas):"")"
"1","[1]"
"1"," ""MESES CON GASTOS ANÓMALOS (>3 sigmas):"""
"1","
"
"0","print(meses_anomalos)"
